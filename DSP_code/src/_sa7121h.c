
/********************************************************************/
/* _sa7121h.c file                                                  */
/********************************************************************/

#include <csl_i2c.h>
#include  <csl_gpio.h>
#include "iic.h"
#include "sa7121h.h"

extern GPIO_Handle hGpio;
extern I2C_Handle dm642i2c; 


/*SAA7121H的工作模式为从模式：
	RCV1与RCV2设为输入端，水平同步为RCV2，地址为0x6B，
	SYMP设为高，选择行场同步为656格式，地址为0x3a*/

/*PAL制的显示参数*/
SA7121H_ConfParams sa7121hPAL[45] = {
	{0x26,0x00},{0x27,0x00},{0x28,0x21},{0x29,0x1d},{0x3A,0x13},{0x5A,0x0c},
	{0x5B,0x21},{0x5c,0xAF},{0x5d,0x23},{0x5e,0x35},{0x5f,0x35},{0x60,0x00},
	{0x61,0x06},{0x62,0x2F},{0x63,0xcb},{0x64,0x8a},{0x65,0x09},{0x66,0x2a},
	{0x67,0x55},{0x68,0x56},{0x69,0x67},{0x6a,0x58},{0x6b,0x20},{0x6c,0x05},
	{0x6d,0x20},{0x6e,0xA0},{0x6f,0x14},{0x70,0x80},{0x71,0xe8},{0x72,0x10},
	{0x73,0x42},{0x74,0x03},{0x75,0x03},{0x76,0x05},{0x77,0x16},{0x78,0x04},
	{0x79,0x16},{0x7a,0x18},{0x7b,0x38},{0x7c,0x40},{0x7d,0x00},{0x7e,0x00},
	{0x7F,0x00}				
};
/*NTSC制的显示参数*/
SA7121H_ConfParams sa7121hNTSC[45] = {
	{0x26,0x00},{0x27,0x00},{0x28,0x19},{0x29,0x1d},{0x3A,0x13},{0x5A,0x0c},
	{0x5B,0x76},{0x5c,0xA5},{0x5d,0x2a},{0x5e,0x2e},{0x5f,0x2e},{0x60,0x00},
	{0x61,0x15},{0x62,0x3F},{0x63,0x1f},{0x64,0x7c},{0x65,0xf0},{0x66,0x21},
	{0x67,0x55},{0x68,0x56},{0x69,0x67},{0x6a,0x58},{0x6b,0x20},{0x6c,0xf9},
	{0x6d,0x00},{0x6e,0xb0},{0x6f,0x14},{0x70,0x80},{0x71,0xe8},{0x72,0x10},
	{0x73,0x42},{0x74,0x03},{0x75,0x03},{0x76,0x05},{0x77,0x16},{0x78,0x04},
	{0x79,0x16},{0x7a,0x18},{0x7b,0x38},{0x7c,0x40},{0x7d,0x00},{0x7e,0x00},
	{0x7F,0x00}				
};

void SAA7121_Set(Uint8 NTSCorPAL)
{
    Uint8 addrI2C,aa;

	GPIO_pinWrite(hGpio,GPIO_PIN1,1);

    /****SAA7121初始化****/
	addrI2C = 0x88 >>1;					      
	for(aa =0; aa<43; aa++)
	{
		if(NTSCorPAL == 1)
		{
			_IIC_write(dm642i2c, 
					   addrI2C,
					   (sa7121hNTSC[aa].regsubaddr), 
					   (sa7121hNTSC[aa].regvule));
		}
		else
		{
			_IIC_write(dm642i2c, 
					   addrI2C,
					   (sa7121hPAL[aa].regsubaddr), 
					   (sa7121hPAL[aa].regvule));	
		}		
	}
} 

